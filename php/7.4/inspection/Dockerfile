#===+====1====+====2====+====3====+====4====+====5====+====6====+====7====+====8====+====9====+====0
# コード検査用コンテナ
#===+====1====+====2====+====3====+====4====+====5====+====6====+====7====+====8====+====9====+====0
FROM arielase/develop:php-7.4-cli

#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
# composerのコマンドパス追加
#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
ENV PATH=/root/.composer/vendor/bin:${PATH}

#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
# ソース/設定配置用パスの作成
#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
VOLUME [ "/sources", "/config" ]

#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
# ソース配置用パスを作業ディレクトリに設定
#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
WORKDIR /sources

#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
# 検査用ツールのインストール
#---+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0
RUN set -xe \
    && apk add --update-cache --no-cache parallel \
    && composer global require \
        phpunit/phpunit \
        squizlabs/php_codesniffer \
        phpstan/phpstan \
        phpmd/phpmd \
        sebastian/phpcpd \
    && composer global clear-cache
